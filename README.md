# 概要
本项目用于抓取指定 Bangumi 用户的收藏（书籍、动画、音乐、游戏）评分数据，并生成交互式 HTML 可视化图表，展示每个作品的平均评分与分歧程度（标准差）。

---

# 功能特点
- 自动抓取用户收藏列表
- 多线程并发获取每个作品评分数据，加快爬取速度
- 计算每部作品的平均分和评分标准差
- 按类型（书籍 / 动画 / 音乐 / 游戏）生成交互式图表
- 导出 CSV 文件以便后续分析
- 生成可切换类型的 HTML 页面，点击按钮切换显示

---

# 配置方法
1. **运行脚本并填写参数**  

首先运行 `bangumi_auto.py`，填写以下内容：

| 参数 | 说明 | 默认值 |
|------|------|--------|
| USER_ID | 你的 Bangumi 用户 ID（不是用户名） | 必填 |
| ACCESS_TOKEN | Bangumi API 访问令牌，可在 [开发者平台](https://next.bgm.tv/demo/access-token) 自动生成 | 必填 |
| OUTPUT_CSV / OUTPUT_HTML | 输出文件名，可按需修改 | CSV: bangumi_888347.csv / HTML: index.html |
| REQUEST_DELAY | 请求间隔（秒），可调节抓取速度 | 0.3 |
| MAX_WORKERS | 线程数，增加可加快抓取，但过高可能被 API 限流 | 6 |

2. **注意事项**
- 建议将 `MAX_WORKERS` 设置为 4~6  
- `REQUEST_DELAY` 可调整抓取速度  
- 大量收藏可能需要几分钟  
- ACCESS_TOKEN 过期需重新生成

3. **生成图片**  
如果想要生成图片，请运行 `bgm_see.py`，会读取 CSV 文件生成图片。

---

# HTML 图表说明与分析
生成的 `index.html` 图表展示了用户收藏作品的评分分布。每个点代表一部作品，鼠标悬停可查看作品名称、平均分、标准差和投票人数。  

- **横轴**：评分标准差（分歧程度）  
- **纵轴**：平均评分（整体评价）  

### 可分析信息
![动画评分分布](examples.PNG "动画评分分布")
1. **作品整体评分水平**  
   - 点在纵轴靠上：平均评分高  
   - 点在纵轴靠下：平均评分低

2. **作品评价一致性（分歧程度）**  
   - 点在横轴靠左（标准差小）：评分集中  
   - 点在横轴靠右（标准差大）：评分分歧明显

3. **受欢迎程度**  
   - 鼠标悬停查看 `votes`（投票人数）  
   - 高票数且评分高 → 公认佳作  
   - 高票数但标准差大 → 讨论热度高，但评价分歧明显

4. **类型对比**  
   - 图表按钮切换类型（动画 / 游戏 / 书籍 / 音乐）  
   - 可直观比较不同类型作品的平均分和分歧程度

💡 **提示**：点击按钮切换类型，鼠标悬停查看详细信息

---

# 依赖
- 需要 **Python 3.9** 以上版本，更低版本未测试
- 第三方库：
  - **Requests**：访问 Bangumi API  
  - **Pandas**：数据处理  
  - **Plotly**：绘制交互式散点图  
  - **concurrent.futures**：多线程加速抓取


# 更新说明
- 260110更新： 优化CSS，点击散点图可以看到bangumi详细页面。
- 260111更新： 增加鼠标悬浮高亮显示，以及鼠标悬浮手势。
- 260112更新： 重写按钮，重新python和js，支持动画，游戏，书籍，音乐四种散点图，不像是之前版本把元素写死的方法，如果要扩充电视剧也是很方便就能扩充。悬浮窗可以看到投票总人数。
- 260113更新： 散点图标题显示用户昵称，导出python内的模板html作为template.html。
